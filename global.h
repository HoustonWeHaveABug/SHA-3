#define STATE_LINE 5
#define STATE_SQUARE 25
#define POWER_MAX 6UL
#define WORD_BITS_MAX 64
#define CYCLES_MAX 24

static unsigned long state_y[STATE_SQUARE] = { 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4 };
static unsigned long state_x[STATE_SQUARE] = { 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4 };
static uint64_t truncate[WORD_BITS_MAX] = {
	UINT64_C(0xFFFFFFFFFFFFFFFF),
	UINT64_C(0x7FFFFFFFFFFFFFFF),
	UINT64_C(0x3FFFFFFFFFFFFFFF),
	UINT64_C(0x1FFFFFFFFFFFFFFF),
	UINT64_C(0x0FFFFFFFFFFFFFFF),
	UINT64_C(0x07FFFFFFFFFFFFFF),
	UINT64_C(0x03FFFFFFFFFFFFFF),
	UINT64_C(0x01FFFFFFFFFFFFFF),
	UINT64_C(0x00FFFFFFFFFFFFFF),
	UINT64_C(0x007FFFFFFFFFFFFF),
	UINT64_C(0x003FFFFFFFFFFFFF),
	UINT64_C(0x001FFFFFFFFFFFFF),
	UINT64_C(0x000FFFFFFFFFFFFF),
	UINT64_C(0x0007FFFFFFFFFFFF),
	UINT64_C(0x0003FFFFFFFFFFFF),
	UINT64_C(0x0001FFFFFFFFFFFF),
	UINT64_C(0x0000FFFFFFFFFFFF),
	UINT64_C(0x00007FFFFFFFFFFF),
	UINT64_C(0x00003FFFFFFFFFFF),
	UINT64_C(0x00001FFFFFFFFFFF),
	UINT64_C(0x00000FFFFFFFFFFF),
	UINT64_C(0x000007FFFFFFFFFF),
	UINT64_C(0x000003FFFFFFFFFF),
	UINT64_C(0x000001FFFFFFFFFF),
	UINT64_C(0x000000FFFFFFFFFF),
	UINT64_C(0x0000007FFFFFFFFF),
	UINT64_C(0x0000003FFFFFFFFF),
	UINT64_C(0x0000001FFFFFFFFF),
	UINT64_C(0x0000000FFFFFFFFF),
	UINT64_C(0x00000007FFFFFFFF),
	UINT64_C(0x00000003FFFFFFFF),
	UINT64_C(0x00000001FFFFFFFF),
	UINT64_C(0x00000000FFFFFFFF),
	UINT64_C(0x000000007FFFFFFF),
	UINT64_C(0x000000003FFFFFFF),
	UINT64_C(0x000000001FFFFFFF),
	UINT64_C(0x000000000FFFFFFF),
	UINT64_C(0x0000000007FFFFFF),
	UINT64_C(0x0000000003FFFFFF),
	UINT64_C(0x0000000001FFFFFF),
	UINT64_C(0x0000000000FFFFFF),
	UINT64_C(0x00000000007FFFFF),
	UINT64_C(0x00000000003FFFFF),
	UINT64_C(0x00000000001FFFFF),
	UINT64_C(0x00000000000FFFFF),
	UINT64_C(0x000000000007FFFF),
	UINT64_C(0x000000000003FFFF),
	UINT64_C(0x000000000001FFFF),
	UINT64_C(0x000000000000FFFF),
	UINT64_C(0x0000000000007FFF),
	UINT64_C(0x0000000000003FFF),
	UINT64_C(0x0000000000001FFF),
	UINT64_C(0x0000000000000FFF),
	UINT64_C(0x00000000000007FF),
	UINT64_C(0x00000000000003FF),
	UINT64_C(0x00000000000001FF),
	UINT64_C(0x00000000000000FF),
	UINT64_C(0x000000000000007F),
	UINT64_C(0x000000000000003F),
	UINT64_C(0x000000000000001F),
	UINT64_C(0x000000000000000F),
	UINT64_C(0x0000000000000007),
	UINT64_C(0x0000000000000003),
	UINT64_C(0x0000000000000001)
};
static unsigned long add1[STATE_LINE] = { 1, 2, 3, 4, 0 };
static unsigned long sub1[STATE_LINE] = { 4, 0, 1, 2, 3 };
static unsigned long sum2x3y[STATE_LINE][STATE_LINE] = {
	{ 0, 3, 1, 4, 2 },
	{ 2, 0, 3, 1, 4 },
	{ 4, 2, 0, 3, 1 },
	{ 1, 4, 2, 0, 3 },
	{ 3, 1, 4, 2, 0 }
};
static unsigned long add2[STATE_LINE] = { 2, 3, 4, 0, 1 };
static uint64_t rc[CYCLES_MAX] = {
	UINT64_C(0x0000000000000001),
	UINT64_C(0x0000000000008082),
	UINT64_C(0x800000000000808A),
	UINT64_C(0x8000000080008000),
	UINT64_C(0x000000000000808B),
	UINT64_C(0x0000000080000001),
	UINT64_C(0x8000000080008081),
	UINT64_C(0x8000000000008009),
	UINT64_C(0x000000000000008A),
	UINT64_C(0x0000000000000088),
	UINT64_C(0x0000000080008009),
	UINT64_C(0x000000008000000A),
	UINT64_C(0x000000008000808B),
	UINT64_C(0x800000000000008B),
	UINT64_C(0x8000000000008089),
	UINT64_C(0x8000000000008003),
	UINT64_C(0x8000000000008002),
	UINT64_C(0x8000000000000080),
	UINT64_C(0x000000000000800A),
	UINT64_C(0x800000008000000A),
	UINT64_C(0x8000000080008081),
	UINT64_C(0x8000000000008080),
	UINT64_C(0x0000000080000001),
	UINT64_C(0x8000000080008008)
};
